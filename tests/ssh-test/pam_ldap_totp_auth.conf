# PAM LDAP TOTP Configuration for SSH Testing
# This file tests challenge-response mode with SSH

# LDAP connection settings
ldap_uri ldap://openldap:389
ldap_base dc=example,dc=com

# Authentication mode
# challenge = separate prompts (DEFAULT, works with SSH)
# append = password+OTP concatenated (OpenVPN mode)
totp_mode challenge

# Challenge prompt (shown when requesting TOTP code)
challenge_prompt TOTP code:

# TOTP secret attribute in LDAP
totp_attribute totpSecret

# TOTP prefix (leave empty for no prefix)
totp_prefix

# TOTP time step (seconds)
time_step 30

# TOTP window size (number of time steps to check, ±window_size)
# window_size 3 = check ±90 seconds
window_size 3

# TOTP code digits
totp_digits 6

# Scratch code digits
scratch_digits 8

# MFA grace period (days)
grace_period_days 7

# Enforcement mode
# graceful = allow during grace period
# strict = require immediately
enforcement_mode graceful

# Status attribute
status_attribute totpStatus

# Enrolled date attribute
enrolled_date_attribute totpEnrolledDate

# Grace period attribute (LDAP attribute for user-specific grace period)
grace_period_attribute mfaGracePeriodDays

# Grace message (shown to users during grace period)
grace_message Please visit https://auth.example.com/manage_mfa to set up MFA

# Show grace period message to users
show_grace_message true

# Group requirement attribute
group_mfa_attribute mfaRequired

# Debug logging
debug true
